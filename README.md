# Лабораторная работа 7 — Слоистая архитектура и DDD-lite для оплаты заказа

## Обзор
Проект реализует небольшую систему оплаты заказов с использованием слоистой архитектуры и DDD-lite принципов.  
Демонстрируется разделение ответственности, доменное моделирование и управление бизнес-кейсами без подключения к реальной базе данных.

## Архитектура

Проект разделён на четыре слоя:

- Domain (Домен) — бизнес-логика, сущности, value-объекты и инварианты  
- Application (Приложение) — координирует работу use-case и выполняет бизнес-операции  
- Infrastructure (Инфраструктура) — технические реализации интерфейсов (репозитории, платежный шлюз)  
- Tests (Тесты) — проверка работы use-case и соблюдения правил домена без базы данных  

## Доменная модель

- Order (Заказ) — корень агрегата  
- OrderLine (Строка заказа) — часть агрегата  
- Money (Деньги) — value-объект для суммы и валюты  
- OrderStatus (Статус заказа) — перечисление возможных состояний  

Все бизнес-правила (например, запрет оплаты пустого заказа и запрет изменения после оплаты) реализованы на уровне домена.

## Use-case

PayOrderUseCase выполняет следующие шаги:

1. Получает заказ из репозитория  
2. Выполняет оплату на уровне домена  
3. Вызывает платежный шлюз  
4. Сохраняет обновлённый заказ  
5. Возвращает результат оплаты  

## Инфраструктура

- InMemoryOrderRepository — хранение заказов в памяти для тестирования  
- FakePaymentGateway — имитация процесса оплаты без реальных транзакций  

## Тестирование

- Все тесты выполняются без базы данных  
- Проверяют успешную оплату, запрет оплаты пустого или уже оплаченного заказа, запрет изменения после оплаты и корректность подсчёта итоговой суммы  
